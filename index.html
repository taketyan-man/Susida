<html>
  <head>
    <script>
      let Q = [
      //cmd + key
      ['ファイルを開く', 'Cmd + O', 0, "KeyO"], 
      //['新しいファイルを開く', 'Cmd + N', 0, "KeyN"], 
      ['ファイルの保存', 'Cmd + S', 0, "KeyS"], 
      ['クイックオープンウィンドウ', 'Cmd + P', 0, "KeyP"], 
      ['サイドバーの開閉', 'Cmd + B', 0, 'KeyB'], 
      ['カーソルの下に行を挿入', 'Cmd + Enter', 0, "Enter"],
      ['選択行をコメント化', 'Cmd + /', 0, 'Slash'],
      ['文字の検索', 'Cmd + F', 0, 'KeyF'],
      ['ファイルの最初へジャンプ', 'Cmd + 上矢印', 0, "ArrowUp"],
      ['ファイルの最後へジャンプ', 'Cmd + 下矢印', 0, "ArrowDown"],
      ['同じ文字列を複数選択', 'Cmd + D', 0, 'KeyD']

      //ctrl + key
      // ['タブの移動', 'Ctrl + tab', 1],
      ['行を指定してジャンプ', 'Ctrl + G', 1, "KeyG"],
      //option + key
      ['選択行を上に移動', 'Option + 上矢印キー', 2, 'ArrowUp'],
      ['選択行を下に移動', 'Option + 下矢印キー', 2, 'ArrowDown'],
      ['文字の先頭へジャンプ', 'Option + 左矢印キー', 2, 'ArrowLeft'],
      ['文字の最後へジャンプ', 'Option + 右矢印キー', 2, 'ArrowRight'],
      //shift + cmd + key
      ['エクスプローラーを開く', 'Shift + Cmd + E', 3, 'KeyE'],
      ['名前を付けてファイルを保存', 'Shift + Cmd + S', 3, 'KeyS'],
      ['カーソルの上に行を挿入', 'Shift + Cmd + Enter', 3, 'Enter'],
      ['選択行の削除', 'Shift + Cmd + K', 3, 'KeyK'],
      
      ['ワークスペース全体を検索', 'Shift + Cmd + F', 3, 'KeyF'],
      // option + cmd + key
      ['文字の置き換え', 'Option + Cmd + F', 4, 'KeyF'],
      //shift + option + key
      ['選択行を上にコピー', 'Option + Shift + 上矢印キー', 5, 'ArrowUp'],
      ['選択行を下にコピー', 'Option + Shift + 下矢印キー', 5, 'ArrowDown']
      ];

      let Q_No = Math.floor( Math.random() * Q.length)
      let Q_Q =  Q[Q_No].length;

      const controller = {};

      const showController = () => {
        const elem = document.getElementById("debug-controller");
        let controllerStr = "";
        Object.keys(controller).forEach(key => {
          controllerStr += `${key}:${controller[key]} \n`;
        });
      }

      document.addEventListener('keydown', (event) => {
        event.preventDefault();
        console.log(`keydown:${event.code}`);
        document.getElementById("question").innerHTML = Q[Q_No][0];
        controller[event.code] = true;
        showController();
        push_Keydown(event, controller);
      });

      document.addEventListener('keyup', (event) => {
        event.stopPropagation();
        console.log(`keyup:${event.code}`);
        controller[event.code] = false;
        showController();
      });

      function jg_Key(){
        if(controller[Q[Q_No][3]]){ 
            Q_No = Math.floor( Math.random() * Q.length);
            document.getElementById("question").innerHTML = Q[Q_No][0];
        };
      };

      function push_Keydown(event, controller){
        let keyCode = event.key;
        // Object.keys(controller).forEach(key => {

        // })
        if(Q[Q_No][2] == 0){
          if(controller["MetaLeft"]){
            jg_Key();
          }else if(controller["MeteRight"]){
            jg_Key();
          };
        }else if(Q[Q_No][2] == 1){  
          if(controller["ControlLeft"]){
            jg_Key();
          };
        }else if(Q[Q_No][2] == 2){
          if(controller["AltLeft"]){
            jg_Key();
          };
        }else if(Q[Q_No][2] == 3){
          if(controller["ShiftRight"]){
            if(controller["MetaLeft"]){
              jg_Key();
            }else if(controller["MetaRight"]){
              jg_Key();
            };
          }else if(controller["ShiftLeft"]){
            if(controller["MetaLeft"]){
              jg_Key();
            }else if(controller["MetaRight"]){
              jg_Key();
            };
          };
        }else if(Q[Q_No][2] == 4){
          if(controller["AltLeft"]){
            if(controller["MetaLeft"]){
              jg_Key();
            }else if(controller["MetaRight"]){
              jg_Key();
            };
          };
        }else if(Q[Q_No][2] == 5){
          if(controller["AltLeft"]){
            if(controller["ShiftRight"]){
              jg_Key();
            }else if(controller["ShiftLeft"]){
              jg_Key();
            };
          };
        };
      };
      
      </script>
  </head>
  <body>
    <div id="result" style="font-size: 1.2em;font-weight: bold;">経過秒数:</div>
    <button class="startbtn">初心者(29)</button>
    <button class="startbtn" disabled>中級者</button>
    <button class="startbtn" disabled>上級者</button>
    <p><input type="button" value="stop" id="startbtn"></p>
    <p><input type="button" value="stop" id="stopbtn"></p>
    <h1 id="push">入力したコード</h1>
    <h1 id="start">何かキーを押して下さい</h1>
    <h1 id="question">ショートカットキー問題</h1>
    <script src="main.js"></script>    
  </body>